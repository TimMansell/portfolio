'use strict';

// Some variables.
var appConfig = {
	breakpoints: {
		xs: 767,
		sm: 991,
		md: 1199
	}
};

// Init app with dependencies.
(function() {
	angular
		.module('TM', [])
  		.config(['$locationProvider', function ($locationProvider) {
  	}]);
})();
(function() {
    'use strict';

    angular
        .module('TM')
        .directive('tmCarousel', tmCarousel);

    function tmCarousel() {
      var directive = {
        link: link,
        restrict: 'EA'
      };
      return directive;

      function link(scope, element, attrs) {
        var autoplay = (attrs.autoplay) ? true : false,
            speed =  (attrs.speed) ? attrs.speed : 3000;

        element.slick({
          autoplay: autoplay,
          autoplaySpeed: speed
        });        
      }
    }
})();
(function() {
    'use strict';

    angular
        .module('TM')
        .directive('tmCenterContent', tmCenterContent);

    function tmCenterContent() {
      var directive = {
        link: link,
        restrict: 'EA'
      };
      return directive;

      function link(scope, element, attrs) {
        var $window = angular.element(window),
            $container = (attrs.element) ? element.find(attrs.element) : element.children()[0];
        
        function positionContainer() {
          $container.css('top', ( ( element.height() - $container.height() - 20 ) / 2) + 'px' );
        }

        $window.on('resize', function(){ 
          positionContainer();  
        });

        // Init.
        positionContainer();
      }
    }
})();
(function() {
    'use strict';

    angular
        .module('TM')
        .directive('tmLazyLoad', tmLazyLoad);

    function tmLazyLoad() {
      var directive = {
        link: link,
        restrict: 'EA'
      };
      return directive;

      function link(scope, element, attrs) {
        var autoplay = (attrs.autoplay) ? true : false,
            speed =  (attrs.speed) ? attrs.speed : 3000;

        element.slick({
          autoplay: autoplay,
          autoplaySpeed: speed
        });        
      }
    }
})();
(function() {
    'use strict';

    angular
        .module('TM')
        .directive('tmScrollFade', tmScrollFade);

    function tmScrollFade() {
      var directive = {
        link: link,
        restrict: 'EA'
      };
      return directive;

      function link(scope, element, attrs) {
        var $window = angular.element(window),
            opacity;

        $window.on('scroll', function(e){
          opacity = 1 - ($window.scrollTop() / $window.height()) * 1.15;

          if (opacity >= 0){
            element.css('opacity', opacity);
          }
        }) ;    
      }
    }
})();
(function() {
    'use strict';

    angular
        .module('TM')
        .directive('tmShuffleContent', tmShuffleContent);

    tmShuffleContent.$inject = ['$interval'];

    function tmShuffleContent($interval) {
      var directive = {
        link: link,
        restrict: 'EA'
      };
      return directive;

      function link(scope, element, attrs) {
        var $elements = element.children(),
            elementsArray = $elements.toArray(),
            containerHeight = element.height();

        // Set height of container.
        element.height(containerHeight);

        $interval(function(){
          $elements.hide();            
          shuffle();
        }, 4000);

        // Shuffle text.
        function shuffle(){
          angular.element(elementsArray[0]).show().shuffleLetters();

          elementsArray.push(elementsArray.shift());
        }

        // Init.
        shuffle(); 
      }
    }
})();
(function() {
    'use strict';

    angular
        .module('TM')
        .directive('tmNavigation', tmNavigation);

    function tmNavigation() {
      var directive = {
        link: link,
        //templateUrl: '/template/is/located/here.html',
        restrict: 'EA'
      };
      return directive;

      function link(scope, element, attrs) {
        var $window = angular.element(window);

        // Stick Navigation.
        element.stickyNavbar({
          mobileWidth: appConfig.breakpoints.xs,
          stickyModeClass: 'is-sticky'
          //startAt: 500
        });

        /*element.find('ul').onePageNav({
          scrollSpeed: 400 
        });*/

        /*$window.on('scroll', function(){
          if($window.scrollTop() < $window.height()/2) {
            element.find('li').removeClass('current');
            //element.
            //scope.
          }
        });

        $window.on('resize', function(e){ 
          console.log('e', e);
          if(e.target.innerWidth > appConfig.breakpoints.xs){

          }
        });*/
      }
    }
})();
(function() {
    'use strict';

    angular
        .module('TM')
        .directive('tmPortfolio', tmPortfolio);

    function tmPortfolio() {
      var directive = {
        link: link,
        templateUrl: '/templates/portfolio.html',
        restrict: 'EA',
        controller: portfolioController,
        controllerAs: 'pf',
        bindToController: true
      };
      return directive;

      function link(scope, element, attrs) {
        
      }

      portfolioController.$inject = ['$scope', 'portfolioService'];

      function portfolioController($scope, portfolioService) {
        var pf = this;
            
        pf.items = [];
         
        init();

        ////////////

        function init() {
            return portfolioService.get().then(function(data) {
                pf.items = data;

                return pf.items;
            });
        }
      }
    }
})();
(function() {
    'use strict';

    angular
        .module('TM')
        .factory('portfolioService', portfolioService);

    portfolioService.$inject = ['$http'];

    function portfolioService($http) {
	    var service = {
	        get: get
	    };

	    return service;

	    function get(){
        	return $http.get('json/portfolio.json')
	            .then(success)
	            .catch(failed);

	        function success(response) {
	            return response.data;
	        }

	        function failed(error) {
	            //logger.error('XHR Failed for getAvengers.' + error.data);
	        }
	    }
	}
})();